var JS_1905_COM = 'm1905.com';var JS_1905_CN = 'm1905.cn';(function(window) {  function F$(element) {    return typeof(element) == "object" ? element : document.getElementById(element);  };  // è·å– event å…¼å®¹  function getEvent() {    if (document.all) return window.event;    func = getEvent.caller;    while (func != null) {      var arg0 = func.arguments[0];      if (arg0) {        if ((arg0.constructor == Event || arg0.constructor == MouseEvent) || (typeof(arg0) == 'object' && arg0.preventDefault && arg0.stopPropagation)) {          return arg0;        };      };      func = func.caller;    };    return null;  };  // è®¾ç½®CSSå±æ??  function setStyle(elem, prop) {    for (var i in prop) {      elem.style[i] = prop[i];    };  };  // è·å–CSSå±æ??  function getStyle(elem, name) {    if (elem.style[name] != '') return elem.style[name];    if ( !! window.ActiveXObject) return elem.currentStyle[name];    return document.defaultView.getComputedStyle(elem, "").getPropertyValue(name.replace(/([A-Z])/g, "-$1").toLowerCase());  }  // è·å–é¼ æ ‡å…‰æ ‡ç›¸å¯¹äºæ•´ä¸ªé¡µé¢çš„ä½ç½®  function getX(e) {    e = e || window.event;    var _left = document.documentElement.scrollLeft || document.body.scrollLeft;    return e.pageX || e.clientX + _left;  };  function getY(e) {    e = e || window.event;    var _top = document.documentElement.scrollTop || document.body.scrollTop;    return e.pageY || e.clientY + _top;  };  // è·å–å…ƒç´ åˆ°é¡µé¢çš„åæ ‡  function pageX(elem) {return elem.offsetParent ? (elem.offsetLeft + pageX(elem.offsetParent)) : elem.offsetLeft;};  function pageY(elem) {return elem.offsetParent ? (elem.offsetTop + pageY(elem.offsetParent)) : elem.offsetTop;};  // ä¸»ä½“å‡½æ•°å¼?å§?  var Mark = function(elem) {    if (!elem) {                elem = document.getElementById("focusphoto");    }     typeof(zoom) == "number" ? this.zoom = zoom : this.zoom = 1; // è®°å½•ç¼©æ”¾çš„å?æ•°  zoomä¸ºå…¨å±?å˜é‡ï¼Œå—æ”¾å¤§ç¼©å°æŒ‰é’®æ§åˆ¶ï¼Œå¦‚æœä¸å­˜åœ¨è¯¥åŠŸèƒ½è¿™é‡Œå°†é»˜è®¤æ˜? 1    this.elem = elem;         };  Mark.prototype = {    // ç›‘æµ‹å›¾ç‰‡åŠ è½½å®Œæˆ    photoLoad: function(elem, _f) {      if (!elem) {                elem = document.getElementById("focusphoto");      }else{        if (!!window.ActiveXObject) {            if (elem.readyState == "complete") {              if (_f) _f(); // å›è°ƒå‡½æ•°            };        } else {            if (elem.complete == true) {              if (_f) _f(); // å›è°ƒå‡½æ•°            };        };      }          },    // åˆå§‹åŒ–çš„ç›¸å…³å‡½æ•°    init: function(r) { // åˆå§‹åŒ–mark         $("#makeMarkFloor,#selectMark,#showMark").remove();      var html = '<div id="makeMarkFloor"></div><div class="selectMark" id="selectMark"><div class="LED" id="LED"><div id="moveLED"></div><div class="topLED" id="topLED"></div><div class="rightLED" id="rightLED"></div><div class="bottomLED" id="bottomLED"></div><div class="leftLED" id="leftLED"></div><div class="sizaHand" id="LED01Hand"></div><div class="sizaHand" id="LED03Hand"></div><div class="sizaHand" id="LED06Hand"></div><div class="sizaHand" id="LED08Hand"></div></div></div><div class="showMark" id="showMark" style="display:none"><div class="div"><p></p></div><div class="sm_content"><i></i><span class="img"></span><span class="txt"></span></div></div>';      $(html).appendTo('#photoMod');       var that = this;      this.initEvent();      this.setMarkList(this.getMark(r)); // è®¾ç½®åˆå§‹çŠ¶æ?ä¸‹çš„mark      this.filterMark(this.getMark(r)); // é¼ æ ‡æ»‘è¿‡å›¾ç‰‡ç­›é?‰æ˜¾ç¤ºmark      this.setBoxSize(); // è®¾ç½®å›¾ç‰‡çˆ¶èŠ‚ç‚¹å®½åº? ä»¥ä¾¿å±…ä¸­    },    initEvent: function() { // åˆå§‹åŒ–è¦æ³¨å†Œçš„äº‹ä»?      var that = this;      $('body').delegate('#startMark', 'click',function(){        that.start(1);      });      $('body').delegate('#startMark_2', 'click',function(){        that.start(2);      });        // F$("startMark_2").onclick = function() {        //   that.start(2);        // };      // åˆå§‹åŒ–å°±ç›´æ¥æ·»åŠ åœ¨é¡µé¢ä¸­æ˜¾ç¤ºmarkèŠ‚ç‚¹çš„æ»‘è¿‡éšè—?      F$("showMark").getElementsByTagName("p")[0].onmouseout = function() {        //setStyle(F$("showMark"), {display:"none"});        that.hideMark();      };    },    setBoxSize: function() { // è®¾ç½®åŒ…å«å›¾ç‰‡èŠ‚ç‚¹çš„å¤§å°ï¼Œä¸ºäº†å±…ä¸­æ•ˆæœ      var _width = F$("focusphoto").scrollWidth;      setStyle(F$("photoMod"), {        width: _width + "px"      });    },    getMark: function(r) { // è·å–å½“å‰å›¾ç‰‡çš„mark      var mark_list = {};      mark_list[r["id"]] = r["data"];      return mark_list[r["id"]];    },    light_onmouseover: function(name, id, x, y, width, height, mark_images, mark_content) { // è®¾ç½®é¡µé¢ä¸­markçš„åˆ—è¡?        var that = this;      var myTime;      clearTimeout(myTime);      that.showMark(name, x, y, width, height, mark_images, mark_content);    },    setMarkList: function(elems) { // è®¾ç½®é¡µé¢ä¸­markçš„åˆ—è¡?        $("#makeList").html("");      var makeElem = F$("makeList");      for (var i = 0; i < elems.length; i++) {        if (Boolean(elems[i]) && elems[i].flag==0) {          var _div = document.createElement("a");          _div.setAttribute("id", "mark_"+elems[i].id);          _div.setAttribute("target", "_blank");          _div.setAttribute("href", 'http://d.'+JS_1905_COM+'/space/'+elems[i].uid);               var _b = document.createElement("strong");          var _text = document.createTextNode(elems[i].title);          var _text2 = document.createTextNode(elems[i].title);          var closeText = document.createTextNode("X");          var _em = document.createElement("em");          _em.setAttribute("onclick", 'deleteData(\''+elems[i].id+ '\')');          var _span = document.createElement("i");          setStyle(_em, {display: "none"});          _b.appendChild(_text);          _div.appendChild(_b);          _em.appendChild(_text2);          _span.appendChild(closeText);          _em.appendChild(_span);          _div.appendChild(_em);          makeElem.appendChild(_div);          this.eventMark(_b, _em, _span, elems[i].id, elems[i].x, elems[i].y, elems[i].width, elems[i].height, elems[i].mark_images, elems[i].mark_content);        }      };    },        eventMark: function(_b, _em, _span, mark_id, mark_x, mark_y, mark_width, mark_height, mark_images, mark_content) { // æ³¨å†Œæ˜¾ç¤ºã€åˆ é™¤äº‹ä»?      var that = this;      var myTime;	          _b.onmouseover = function() {        var quan = $('#fancybox-thumbs .active').attr('quan');        clearTimeout(myTime);    		if(quan==1){    			setStyle(this, {display: "none"});    			setStyle(_em, {display: "inline-block"});    		}        that.showMark(_b.innerHTML, mark_x, mark_y, mark_width, mark_height, mark_images, mark_content); // æ˜¾ç¤ºå½“å‰mark      };      _em.parentNode.onmouseout = function() {        clearTimeout(myTime);        setStyle(_em, {display: "none"});        setStyle(_b, {display: "inline-block"});        that.hideMark(); // éšè—å½“å‰mark      };      _em.onmouseover = function() {        var quan = $('#fancybox-thumbs .active').attr('quan');        clearTimeout(myTime);    		if(quan==1){    			setStyle(_b, {display: "none"});    			setStyle(_em, {display: "inline-block"});			    		}    		that.showMark(_b.innerHTML, mark_x, mark_y, mark_width, mark_height, mark_images, mark_content);              };      // åˆ é™¤æ“ä½œ      _span.onclick = function() {        that.removeMark(mark_id);		    getEvent().preventDefault();      };    },    filterMark: function(mydata) { // é¼ æ ‡æ»‘è¿‡å›¾ç‰‡ç­›é?‰æ˜¾ç¤ºmark      // if (!mydata && !-[1,]&&!window.XMLHttpRequest) {return}; //ie6ä¸‹mydataæŠ¥é”™      var that = this;      document.onmousemove = function() {        var elem = F$("focusphoto");        if(!elem){return false}        var _x = getX(getEvent());        var _y = getY(getEvent()) - parseInt($(document).scrollTop());        var elemX = pageX(elem);        var elemY = pageY(elem);        var photoX = _x - elemX;        var photoY = _y - elemY + ((!-[1,]&&!window.XMLHttpRequest)?parseInt($(document).scrollTop()) :  0);        var bigX = elem.scrollWidth;        var bigY = elem.scrollHeight;        if (0 < photoX && 0 < photoY && photoX < bigX && photoY < bigY) { // é¼ æ ‡åœ¨å›¾ç‰‡èŒƒå›´å†…æ—?                      for (var i = 0; i < mydata.length; i++) {            var _top = mydata[i].y;            var _left = mydata[i].x;            var _width = mydata[i].width;            var _height = mydata[i].height;                        var term = (_left * that.PhotoSize.cpu) < photoX && photoX < (parseInt(_left * that.PhotoSize.cpu) + parseInt(_width * that.PhotoSize.cpu)) && (_top * that.PhotoSize.cpu) < photoY && photoY < (parseInt(_top * that.PhotoSize.cpu) + parseInt(_height * that.PhotoSize.cpu));            if (term) {              that.showMark(mydata[i].title, _left, _top, _width, _height, mydata[i].mark_images, mydata[i].mark_content);            } else if(!term){              // that.hideMark();            }          };        };      };    },    showMark: function(str, mark_x, mark_y, mark_width, mark_height, mark_images, mark_content) { // æ˜¾ç¤ºå½“å‰mark              var elem = F$("showMark");      var _top = mark_y * this.PhotoSize.cpu;      var _left = mark_x * this.PhotoSize.cpu;      var _width = mark_width * this.PhotoSize.cpu;      var _height = mark_height * this.PhotoSize.cpu;      setStyle(elem, {        display: "block",        top: parseInt(_top) + "px",        left: parseInt(_left) + "px",        width: parseInt(_width) + "px"      });      setStyle(elem.getElementsByTagName("p")[0], {        width: parseInt(_width) + "px",        height: parseInt(_height) + "px"      });      $("#showMark .img").html('<img src='+ mark_images +' onerror="this.onerror=null;this.src=\'http://nuc.m1905.com/images/noavatar_ding.gif\'"/>');      if(mark_content==""){        $("#showMark .txt").html(str)      }else{        $("#showMark .txt").html('<font class="color2191cb">'+ str +'</font>ï¼?'+ mark_content)      }            // elem.getElementsByTagName("strong")[0].innerHTML = str;    },    hideMark: function() { // éšè—å½“å‰mark      setStyle(F$("showMark"), {display: "none"});    },    removeMark: function(mark_id) { // åˆ é™¤ä¸?ä¸ªmork      //var url = _ROOT_+"/index.php?app=photo&mod=pic&act=doDeleteMark&ids="+mark_id;	  $("#makeList #mark_"+mark_id).remove();	  $.ajax({			        url: _ROOT_+"/index.php?app=photo&mod=pic&act=doDeleteMark",			        type: 'POST',			        cache:false,			        data: {'id':mark_id },			        dataType: 'html',			        success: function (dat){						    $mark_count = parseInt($("#mark_count").html())-1;						    $("#mark_count").html($mark_count);											        }			})		    },    // åœˆäººçš„ç›¸å…³å‡½æ•?    start: function(sort) { // å¯åŠ¨åœˆäººçŠ¶æ??      $(".fancybox-outer").css("overflow","visible");      $("#focusphoto").rotate_wise(0);      $("#focusphoto").attr('angle',0);      $("#qianNote a").text(sort==2 ? "é€?å‡ºåœˆäº®ç‚¹" : "é€?å‡ºåœˆäº?");            F$("qianNote").style.display = "block";      $(".qaunUl li").hide();         setStyle(F$("qianNote"), {display: "block"});      setStyle(F$("startMark"), {display: "none"});      setStyle(F$("fancybox-thumbs"), {display: "none"});      $(".fancybox-title,.btnUlBox").hide();      $(".fancybox-outer").find(".fancybox-nav").hide();      setStyle(F$("makeMarkFloor"), {        display: "block",        width: F$("focusphoto").scrollWidth + "px",        height: F$("focusphoto").scrollHeight + "px"      }); // è¿™é‡Œè®¾ç½®å…·ä½“çš„å®½é«˜æœ‰åŠ©äºå…¼å®¹IE6      this.makeMark(sort);      this.startEvent();      this.hideMark(); // å¯åŠ¨åœˆäººæ—¶éšè—é¡µé¢mark      this.filterMark([]); // é€šè¿‡ä¼ é?’å‡æ•°æ®æ¥ä½¿é¼ æ ‡æ»‘è¿‡ç­›é?‰markåœæ­¢    },    stop: function() { // åœæ­¢åœˆäººçŠ¶æ??      F$("makeMarkFloor").style.display = "none";      F$("selectMark").style.display = "none";      $(".qaunUl li").show();      F$("qianNote").style.display = "none";      F$("startMark").style.display = "inline-block";      F$("fancybox-thumbs").style.display = "block";      $(".fancybox-title,.btnUlBox").show();      $(".fancybox-outer").find(".fancybox-nav").show();      $(".LEDfrom,.LEDlist").remove();      $(".fancybox-outer").css("overflow","hidden");      // this.filterMark(this.getMark(r)); // åœæ­¢åœˆäººæ—¶éœ€è¦å¯åŠ¨é¼ æ ‡æ»‘è¿‡å›¾ç‰‡ç­›é€‰mark    },    makeClose: function() { // æ”¾å¼ƒæ–°åŠ mark      F$("selectMark").style.display = "none"    },    startEvent: function() { // å¼?å¯åœˆäººçŠ¶æ€æ‰€è¦æ³¨å†Œçš„äº‹ä»¶      var that = this      // F$("LEDclose").onclick = function() {      //   that.makeClose()      // };      F$("stopMark").onclick = function() {        that.stop();        return false;      };      this.moveMark();      this.resize();    },    makeMark: function(sort) { // åˆ¶é? æ–°çš„mark      var html;	    var id=$('#fancybox-thumbs .active').attr('id');      if(sort==2){        html='<div class="LEDfrom"><i></i><div class="LEDfromBody"><textarea class="txtArea" placeholder="ç§»åŠ¨è‡³äº®ç‚¹å¤„å¹¶è¯„è®?" id="content"></textarea><input type="hidden" id="markuid" /><input type="hidden" id="markName" /><div class="op"><a href="javascript:void(0)" class="gl" id="mark_gl" onclick="mark_light(); cancelBubble(event);">@</a><span class="tj">0/140</span><input type="button" class="inputBut" value="ç•™è¨€" onclick="addMark('+id+',1)"/></div></div></div>';      }else{		          html='<div class="LEDfrom"><i></i><div class="LEDfromBody"><input type="text" placeholder="è¾“å…¥åç§°ï¼ˆå›è½¦é”®ç¡®è®¤ï¼?" class="inputTxt" id="markuser"/><input type="hidden" id="markuid" /><input type="hidden" id="photoid" value="'+id+'"/><input type="hidden" id="markName" /><input type="hidden" id="markflag" value="0" /></div></div><div class="LEDlist" id="markuserlist"></div>';      }      $(".LEDfrom,.LEDlist").remove();      $(html).appendTo('#selectMark');      var that = this;      var floor = F$("makeMarkFloor");      var focusphoto = F$("focusphoto");      floor.onmousedown = function() {        var x = getX(getEvent()); // å…‰æ ‡åæ ‡        var y = getY(getEvent());        var elemX = pageX(floor); // å…ƒç´ åˆ°é¡µé¢çš„åæ ‡        var elemY = pageY(floor);         var _width, _height, _left, _top;         _left   = x - elemX;        _top    = y - elemY + $(".fancybox-overlay").scrollTop() - $(document).scrollTop();        _height = _width  = 100;        // å¯åŠ¨å‰çš„åˆå§‹åŒ?        that.setLEDstyle({          left  : _left + "px",          top   : _top  + "px",          width : _width + "px",          height: _height + "px"        });        F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _height;        if (floor.setCapture) { // é¼ æ ‡æ•è· æ•è·åæ‰€æœ‰é¼ æ ‡è¾“å…¥éƒ½é’ˆå¯¹è¯¥çª—å£ï¼Œä¸ä¼šäº§ç”Ÿé€‰ä¸­å…¶ä»–å†…å®¹çš„é—®é¢?          floor.setCapture();        } else if (window.captureEvents) {          window.captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);        };        if ("\v" != "v") {          if(getEvent().preventDefault){            getEvent().preventDefault()          }else{            getEvent().returnValue = false;          }        };        document.onmousemove = function() {          var newX = getX(getEvent());          var newY = getY(getEvent()) - $(document).scrollTop();                    // åˆ¶é? å±‚å®šä½          newX < x ? _left = newX - elemX : _left = x - elemX; // æ­£è´Ÿä¸¤ç§æ–¹å¼çš„å®šä½æœ‰æ‰?ä¸åŒ          newY < y ? _top = newY - elemY : _top = y - elemY;          if (_left <= 0) _left = 0; // å®šä½ä¸èƒ½ä¸ºè´Ÿæ•?          if (_top <= 0) _top = 0;          // è™šçº¿æ¡†å¤§å°æ§åˆ?          newX < x ? newX > elemX ? _width = x - newX : _width = x - elemX : _width = newX - x; // æ­£åæ–¹å‘æ‹–æ‹‰è®¡ç®—æ–¹å¼ä¸åŒ å¹¶è®©åæ–¹å‘é¼ æ ‡è¶…å‡ºç»˜åˆ¶èŒƒå›´æ—¶å®½é«˜ä¸è®¡ç®?          newY < y ? newY > elemY ? _height = y - newY : _height = y - elemY : _height = newY - y;          if (newX > (elemX + focusphoto.scrollWidth)) _width = focusphoto.scrollWidth - _left; // æ­£æ–¹å‘æ‹–æ‹‰è¶…å‡ºç»˜åˆ¶èŒƒå›´æ—¶å®½é«˜ä¸è®¡ç®?          if (newY > (elemY + focusphoto.scrollHeight)) _height = focusphoto.scrollHeight - _top;          _height = _width  = 100;          that.setLEDstyle({            left: _left + "px",            top: _top + parseInt($(".fancybox-overlay").scrollTop()) + "px"          });                    F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _height;        };        document.onmouseup = function() {          if (floor.releaseCapture) { // ä¸é¼ æ ‡æ•è·å¯¹åº”ï¼Œé‡Šæ”¾é¼ æ ‡äº‹ä»¶            floor.releaseCapture();          } else if (captureEvents) {            captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);          };          document.onmousemove = null;          document.onmouseup = null;          //that.moveMark();        };      };    },    moveMark: function() { // ç§»åŠ¨æ–°çš„mark      var that = this;      var moveLED = F$("moveLED");      var selectMark = F$("selectMark");      var makeMarkFloor = F$("makeMarkFloor");      moveLED.onmousedown = function() {        var x = getX(getEvent()); // å…‰æ ‡åæ ‡        var y = getY(getEvent());        var elemX = pageX(selectMark); // å…ƒç´ åˆ°é¡µé¢çš„è·ç¦»        var elemY = pageY(selectMark);        var PelemX = pageX(makeMarkFloor); // å…ƒç´ åˆ°é¡µé¢çš„è·ç¦»        var PelemY = pageY(makeMarkFloor);        if (moveLED.setCapture) { // é¼ æ ‡æ•è· æ•è·åæ‰€æœ‰é¼ æ ‡è¾“å…¥éƒ½é’ˆå¯¹è¯¥çª—å£ï¼Œä¸ä¼šäº§ç”Ÿé€‰ä¸­å…¶ä»–å†…å®¹çš„é—®é¢?          moveLED.setCapture();        } else if (captureEvents) {          captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);        };        if ("\v" != "v") {          if(getEvent().preventDefault){            getEvent().preventDefault()          }else{            getEvent().returnValue = false;          }        };        document.onmousemove = function() {          var _left = getX(getEvent()) - x + elemX - PelemX;          var _top = getY(getEvent()) - y + elemY - PelemY;          var LEDwidth = F$("LED").scrollWidth;          var floorWidth = F$("focusphoto").scrollWidth;          var LEDheight = F$("LED").scrollHeight;          var floorHeight = F$("focusphoto").scrollHeight;          // ç§»åŠ¨æ—¶é¼ æ ‡è¶…å‡ºèŒƒå›´é”å®?          if (_left <= 0) _left = 0;          if ((_left + LEDwidth) >= floorWidth) _left = floorWidth - LEDwidth;          if (_top <= 0) _top = 0;          if ((_top + LEDheight) >= floorHeight) _top = floorHeight - LEDheight;          that.setLEDstyle({            top: _top + "px",            left: _left + "px"          });          F$("markName").value = _left + " & " + _top + " & " + LEDwidth + " & " + LEDheight;        };        document.onmouseup = function() {          if (moveLED.releaseCapture) { // ä¸é¼ æ ‡æ•è·å¯¹åº”ï¼Œé‡Šæ”¾é¼ æ ‡äº‹ä»¶            moveLED.releaseCapture();          } else if (window.captureEvents) {            window.captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);          };          document.onmousemove = null;          document.onmouseup = null;        };      };    },    resize: function() { // æ‰‹æŸ„æ§åˆ¶å¤§å°      var that = this;      var floor = F$("makeMarkFloor");      var elemX = pageX(floor); // å…ƒç´ åˆ°é¡µé¢çš„è·ç¦»      var elemY = pageY(floor);      var floorHeight = parseInt(F$("focusphoto").scrollHeight);      var floorWidth = parseInt(F$("focusphoto").scrollWidth);      var _hand = [F$("LED01Hand"), F$("topLED"), F$("LED03Hand"), F$("rightLED"), F$("leftLED"), F$("LED06Hand"), F$("bottomLED"), F$("LED08Hand")]; // æ‰‹æŸ„æ§åˆ¶ç‚¹é›†å?      for (var i = 0; i < _hand.length; i++) {        _hand[i].onmousedown = function() {          var x = getX(getEvent()); // å…‰æ ‡åæ ‡          var y = getY(getEvent());          var thatHand = this;          // è®°å½•å½“å‰æ•°æ®          var elemTop = parseInt(getStyle(F$("selectMark"), "top"));          var elemLeft = parseInt(getStyle(F$("selectMark"), "left"));          var elemWidth = parseInt(getStyle(F$("LED"), "width"));          var elemHeight = parseInt(getStyle(F$("LED"), "height"));          if (this.setCapture) { // é¼ æ ‡æ•è· æ•è·åæ‰€æœ‰é¼ æ ‡è¾“å…¥éƒ½é’ˆå¯¹è¯¥çª—å£ï¼Œä¸ä¼šäº§ç”Ÿé€‰ä¸­å…¶ä»–å†…å®¹çš„é—®é¢?            this.setCapture();          } else if (captureEvents) {            captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);          };          if ("\v" != "v") {            if(getEvent().preventDefault){              getEvent().preventDefault()            }else{              getEvent().returnValue = false;            }          };          document.onmousemove = function() {            var _width, _hieght, _top, _left;            var selectMark = F$("selectMark");            var LED = F$("LED");            var moveX = getX(getEvent()) - x;            var moveY = getY(getEvent()) - y;            var Way = {              top: function() {                _hieght = elemHeight + (moveY * -1);                _top = elemTop + moveY;                if (_top <= 0) { // è¶…å‡ºèŒƒå›´çš„é™åˆ?                  _top = 0;                  _hieght = elemHeight + elemTop;                };                if (_hieght <= 0) { // è½¬å‘                  _top = elemHeight + elemTop; // åå‘æ—¶é”å®štop                  _hieght = _hieght * -1;                  var newTop = pageY(F$("LED")) - elemY;                  if ((_hieght + newTop) >= floorHeight) _hieght = floorHeight - newTop;                  that.setLEDstyle({                    top: _top + "px",                    height: _hieght + "px"                  });                } else { // æ­£å‘                  that.setLEDstyle({                    top: _top + "px",                    height: _hieght + "px"                  });                };                _left  = parseInt($("#selectMark").css("left"));                _width = parseInt($("#LED").css("width"));                F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _height;              },              bottom: function() {                _hieght = elemHeight + moveY;                if ((_hieght + elemTop) >= floorHeight) _hieght = floorHeight - elemTop;                if (_hieght <= 0) { // è½¬å‘                  _hieght = _hieght * -1;                  _top = getY(getEvent()) - elemY;                  if (_top <= 0) { // åå‘è¶…å‡ºèŒƒå›´é™åˆ¶                    _top = 0;                    _hieght = elemTop;                  };                  that.setLEDstyle({                    top: _top + "px",                    height: _hieght + "px"                  });                } else { // æ­£å‘                  _top = elemTop;                  that.setLEDstyle({                    top: _top + "px",                    height: _hieght + "px"                  });                };                 _left  = parseInt($("#selectMark").css("left"));                _width = parseInt($("#LED").css("width"));                F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _hieght;                         },              left: function() {                _width = elemWidth + (moveX * -1);                _left = elemLeft + moveX;                if (_left <= 0) { // è¶…å‡ºèŒƒå›´çš„é™åˆ?                  _left = 0;                  _width = elemWidth + elemLeft;                };                if (_width <= 0) { // è½¬å‘                  _left = elemWidth + elemLeft; // åå‘æ—¶é”å®šleft                  _width = _width * -1;                  var newLeft = pageX(F$("LED")) - elemX;                  if ((_width + newLeft) >= floorWidth) _width = floorWidth - newLeft;                  that.setLEDstyle({                    left: _left + "px",                    width: _width + "px"                  });                  //F$("markName").value = elemWidth + elemLeft;                } else { // æ­£å‘                  that.setLEDstyle({                    left: _left + "px",                    width: _width + "px"                  });                };                _top    = parseInt($("#selectMark").css("top"));                _height = parseInt($("#LED").css("height"));                F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _height;              },              right: function() {                _width = elemWidth + moveX;                if ((_width + elemLeft) >= floorWidth) _width = floorWidth - elemLeft;                if (_width <= 0) { // è½¬å‘                  _width = _width * -1;                  _left = getX(getEvent()) - elemX;                  if (_left <= 0) { // åå‘è¶…å‡ºèŒƒå›´é™åˆ¶                    _left = 0;                    _width = elemLeft;                  };                  that.setLEDstyle({                    left: _left + "px",                    width: _width + "px"                  });                } else { // æ­£å‘                  _left = elemLeft;                  that.setLEDstyle({                    left: _left + "px",                    width: _width + "px"                  });                };                _top    = parseInt($("#selectMark").css("top"));                _height = parseInt($("#LED").css("height"));                F$("markName").value = _left + " & " + _top + " & " + _width + " & " + _height;              },              leftUp: function() {                this.left();                this.top();              },              rightUp: function() {                this.right();                this.top();              },              leftDown: function() {                this.left();                this.bottom();              },              rightDown: function() {                this.right();                this.bottom();              }            };            switch (thatHand.id) {              case "LED01Hand":                Way.leftUp();                break;              case "topLED":                Way.top();                break;              case "LED03Hand":                Way.rightUp();                break;              case "rightLED":                Way.left();                break;              case "leftLED":                Way.right();                break;              case "LED06Hand":                Way.leftDown();                break;              case "bottomLED":                Way.bottom();                break;              case "LED08Hand":              default:                Way.rightDown();            };          };          document.onmouseup = function() {            if (this.releaseCapture) { // ä¸é¼ æ ‡æ•è·å¯¹åº”ï¼Œé‡Šæ”¾é¼ æ ‡äº‹ä»¶              this.releaseCapture();            } else if (captureEvents) {              captureEvents(Event.MOUSEMOVE | Event.MOUSEUP);            };            document.onmousemove = null;            document.onmouseup = null;          };        };      };    },    setLEDstyle: function(context) {            var selectMark = F$("selectMark");      var LED = F$("LED");      setStyle(selectMark, {display: "block"});      if (context.left) {        setStyle(selectMark, {left: context.left})      };      if (context.top) {        setStyle(selectMark, {top: context.top});      };      if (context.width) {        setStyle(LED, {width: context.width})      };      if (context.height) {        setStyle(LED, {height: context.height});        // ä¸‹é¢çš„æ˜¯å› ä¸ºIE6ä¸‹çš„100%é«˜åº¦ä¸èµ·ä½œç”¨æ“ä½œçš?        setStyle(F$("moveLED"), {height: context.height});        setStyle(F$("rightLED"), {height: context.height});        setStyle(F$("leftLED"), {height: context.height});      };      // è®¾ç½®æ‰‹æŸ„æ§åˆ¶ç‚¹å®šä½?      var handLeft = (parseInt(LED.scrollWidth) - 8) / 2;      var handTop = (parseInt(LED.scrollHeight) - 8) / 2;    },    submitMark: function() { // æäº¤mark      var x = Math.floor(parseInt(getStyle(F$("selectMark"), "left")) / this.PhotoSize.cpu);      var y = Math.floor(parseInt(getStyle(F$("selectMark"), "top")) / this.PhotoSize.cpu);      var width = Math.floor(parseInt(getStyle(F$("LED"), "width")) / this.PhotoSize.cpu);      var height = Math.floor(parseInt(getStyle(F$("LED"), "height")) / this.PhotoSize.cpu);      var title = F$("markName").value;      var title_uid = F$("tipinput_uid").value;      // title_uid æ˜¯ä¼šå‘˜ID      // type è¡¨ç¤ºé‚£ä¸ªç›¸å†Œ  ç›®å‰æ²¡ç”¨      var params = "x=" + x + "&y=" + y + "&width=" + width + "&height=" + height + "&title=" + title;      // æ”¾å¤§ç¼©å°çš„æ§åˆ?      alert(params);    },    // æ”¾å¤§ç¼©å°æ§åˆ¶    PhotoSize: {      zoom: 0, // ç¼©æ”¾ç?      count: 0, // ç¼©æ”¾æ¬¡æ•°      cpu: 1, // å½“å‰ç¼©æ”¾å€æ•°å€?      elem: "", // å›¾ç‰‡èŠ‚ç‚¹      photoWidth: 0, // å›¾ç‰‡åˆå§‹å®½åº¦è®°å½•      photoHeight: 0, // å›¾ç‰‡åˆå§‹é«˜åº¦è®°å½•      init: function() {        this.elem = F$("focusphoto");        this.photoWidth = this.elem.scrollWidth;        this.photoHeight = this.elem.scrollHeight;        this.zoom = 1.2; // è®¾ç½®åŸºæœ¬å‚æ•°        this.count = 0;        this.cpu = 1;        this.clickEvent(); // æ·»åŠ ç‚¹å‡»äº‹ä»¶      },      clickEvent: function() {        // var bigBut = F$("phptoBig");        // var that = this;        // bigBut.onclick = function(){ that.action(1) };      },      action: function(x) {        if (this.noMake()) {          if (x === 0) {            this.cpu = 1;            this.count = 0;          } else {            this.count += x; // æ·»åŠ è®°å½•            this.cpu = Math.pow(this.zoom, this.count); // ä»»æ„æ¬¡å¹‚è¿ç®—          };          this.elem.style.width = this.photoWidth * this.cpu + "px";          this.elem.style.height = this.photoHeight * this.cpu + "px";          // æ”¹å˜å›¾ç‰‡å¤§å°åéœ€è¦å†æ¬¡è°ƒæ•´å›¾ç‰‡çˆ¶èŠ‚ç‚¹çš„å®½åº¦ï¼Œä»¥ä¾¿å±…ä¸­æ˜¾ç¤º          var _width = F$("focusphoto").scrollWidth;          setStyle(F$("photoMod"), {width: _width + "px"});        };      },      noMake: function() {        if (F$("makeMarkFloor").style.display == "block") {          alert("å¾ˆæŠ±æ­‰ï¼æ‚¨ä¸€å¼?å§‹åœˆäººåŠŸèƒ½ï¼Œæš‚æ—¶æ— æ³•ä½¿ç”¨æ”¾å¤§ç¼©å°ã€?");          return false;        };        return true;      }    }  };  window.Mark = Mark;})(window);